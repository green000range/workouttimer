<!DOCTYPE html>
<html>
<head>
  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <link rel="preconnect" href="https://cdn.jsdelivr.net">
  <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/css/bootstrap.min.css" rel="stylesheet">
  <link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.1/css/all.min.css" rel="stylesheet">
  <style>
    :root {
      --primary-color: #4a90e2;
      --secondary-color: #f5f5f5;
    }
    
    html, body {
      height: 100%;
      margin: 0;
      padding: 0;
      overflow: hidden;
    }
    
    body {
      background-color: var(--secondary-color);
      display: flex;
      align-items: center;
      justify-content: center;
    }
    
    .container {
      height: 100vh;
      max-width: 100%;
      margin: 0;
      padding: 2rem;
      display: flex;
      flex-direction: column;
      justify-content: space-between;
      background: white;
    }
    
    .controls-section {
      flex: 0 0 auto;
    }
    
    .display-section {
      flex: 1 1 auto;
      display: flex;
      flex-direction: column;
      justify-content: center;
      align-items: center;
    }
    
    .form-group {
      display: flex;
      justify-content: center;
      align-items: center;
      gap: 2rem;
      flex-wrap: wrap;
      margin-bottom: 2rem;
    }
    
    .input-group {
      display: flex;
      flex-direction: column;
      align-items: center;
      gap: 0.5rem;
    }
    
    .form-control {
      width: 120px;
      text-align: center;
      font-size: 2rem;
      font-weight: 600;
      border: 2px solid #dee2e6;
      border-radius: 10px;
      padding: 0.5rem;
      transition: all 0.3s ease;
    }
    
    .form-control:focus {
      border-color: var(--primary-color);
      box-shadow: 0 0 0 0.2rem rgba(74, 144, 226, 0.25);
    }
    
    .button-group {
      display: flex;
      justify-content: center;
      gap: 2rem;
      margin-bottom: 2rem;
    }
    
    .btn {
      font-size: 1.5rem;
      font-weight: 600;
      padding: 1rem 3rem;
      border-radius: 10px;
      transition: all 0.3s ease;
    }
    
    .btn-primary {
      background-color: var(--primary-color);
      border-color: var(--primary-color);
    }
    
    .btn-primary:hover {
      background-color: #357abd;
      border-color: #357abd;
    }
    
    #display-container {
      text-align: center;
      padding: 2rem;
      width: 100%;
      display: flex;
      flex-direction: column;
      align-items: center;
      justify-content: center;
    }
    
    #display {
      font-size: clamp(10rem, 30vw, 20rem);
      font-weight: 700;
      color: var(--primary-color);
      margin: 0;
      line-height: 1;
    }
    
    #elapsed {
      font-size: 1rem;
      color: #6c757d;
      opacity: 0.7;
      margin: 1rem 0 0 0;
    }
    
    .fa {
      margin-right: 0.5rem;
    }
    
    label {
      font-size: 1.2rem;
      font-weight: 500;
    }
    
    @media (max-width: 768px) {
      .container {
        padding: 1rem;
      }
      
      .form-group {
        gap: 1rem;
      }
      
      .form-control {
        width: 100px;
        font-size: 1.5rem;
      }
      
      .btn {
        font-size: 1.25rem;
        padding: 0.75rem 2rem;
      }
    }
  </style>
</head>
<body>
  <div class="container">
    <div class="controls-section">
      <div class="form-group">
        <div class="input-group">
          <label for="seconds1">秒数1</label>
          <input id="seconds1" type="number" value="20" min="1" class="form-control">
        </div>
        <div class="input-group">
          <label for="seconds2">秒数2</label>
          <input id="seconds2" type="number" value="10" min="1" class="form-control">
        </div>
        <div class="input-group">
          <label for="times">繰り返し</label>
          <input id="times" type="number" value="8" min="1" class="form-control">
        </div>
      </div>
      
      <div class="button-group">
        <button id="start" class="btn btn-primary"><i class="fas fa-play"></i>スタート</button>
        <button id="stop" class="btn btn-danger" disabled><i class="fas fa-stop"></i>ストップ</button>
      </div>
    </div>
    
    <div class="display-section">
      <div id="display-container">
        <p id="display">0</p>
        <p id="elapsed">経過時間: 0秒</p>
      </div>
    </div>
  </div>

  <audio id="beep10" preload="auto" src="001_ずんだもん（ノーマル）_10秒前.wav"></audio>
  <audio id="beep20" preload="auto" src="002_ずんだもん（ノーマル）_20びょうまえ.wav"></audio>
  <audio id="beep30" preload="auto" src="003_ずんだもん（ノーマル）_30びょうまえ.wav"></audio>
  <audio id="finish" preload="auto" src="finish.mp3"></audio>

  <script>
    const elements = {
      display: document.getElementById("display"),
      elapsed: document.getElementById("elapsed"),
      start: document.getElementById("start"),
      stop: document.getElementById("stop"),
      seconds1: document.getElementById("seconds1"),
      seconds2: document.getElementById("seconds2"),
      times: document.getElementById("times"),
      formGroup: document.querySelector('.form-group'),
      buttonGroup: document.querySelector('.button-group'),
      controlsSection: document.querySelector('.controls-section'),
      sounds: {
        beep10: document.getElementById("beep10"),
        beep20: document.getElementById("beep20"),
        beep30: document.getElementById("beep30"),
        finish: document.getElementById("finish")
      }
    };

    const timerState = {
      timer: null,
      count1: 0,
      count2: 0,
      repeat: 0,
      startTime: 0
    };

    function playSound(sound) {
      sound.currentTime = 0;
      const playPromise = sound.play();
      if (playPromise) {
        playPromise.catch(() => {});
      }
    }

    function updateCount() {
      const now = Date.now();
      const elapsedTime = Math.floor((now - timerState.startTime) / 1000);
      elements.elapsed.textContent = `経過時間: ${elapsedTime}秒`;

      if (timerState.count1 > 0) {
        timerState.count1--;
        elements.display.textContent = timerState.count1;
        
        switch(timerState.count1) {
          case 30: playSound(elements.sounds.beep30); break;
          case 20: playSound(elements.sounds.beep20); break;
          case 10: playSound(elements.sounds.beep10); break;
          case 0: playSound(elements.sounds.finish); break;
        }
      } else if (timerState.count2 > 0) {
        timerState.count2--;
        elements.display.textContent = timerState.count2;
        
        switch(timerState.count2) {
          case 30: playSound(elements.sounds.beep30); break;
          case 20: playSound(elements.sounds.beep20); break;
          case 10: playSound(elements.sounds.beep10); break;
          case 0: playSound(elements.sounds.finish); break;
        }
      } else {
        timerState.repeat--;
        if (timerState.repeat === 0) {
          stop();
        } else {
          timerState.count1 = parseInt(elements.seconds1.value);
          timerState.count2 = parseInt(elements.seconds2.value);
          elements.display.textContent = timerState.count1;
        }
      }
    }

    function start() {
      elements.controlsSection.style.display = 'none';
      
      timerState.count1 = parseInt(elements.seconds1.value);
      timerState.count2 = parseInt(elements.seconds2.value);
      timerState.repeat = parseInt(elements.times.value);
      timerState.startTime = Date.now();
      
      elements.display.textContent = timerState.count1;
      elements.start.disabled = true;
      elements.stop.disabled = false;
      
      timerState.timer = setInterval(updateCount, 1000);
    }

    function stop() {
      clearInterval(timerState.timer);
      elements.start.disabled = false;
      elements.stop.disabled = true;
      elements.display.textContent = "0";
      elements.elapsed.textContent = "経過時間: 0秒";
      elements.controlsSection.style.display = 'block';
    }

    elements.start.addEventListener('click', start);
    elements.stop.addEventListener('click', stop);
  </script>
</body>
</html>
