<script>
  const beep10 = new Audio("001_ずんだもん（ノーマル）_10秒前.wav");
  const beep20 = new Audio("002_ずんだもん（ノーマル）_20びょうまえ.wav");
  const beep30 = new Audio("003_ずんだもん（ノーマル）_30びょうまえ.wav");
  const finish = new Audio("beep.mp3");
  let timer;
  let count1;
  let count2;
  let repeat;
  let startTime;

  function start() {
    const formGroup = document.querySelector('.form-group');
    const buttons = document.querySelector('.text-center');
    formGroup.style.display = 'none';
    buttons.style.display = 'none';

    const display = document.getElementById("display");
    const seconds1 = parseInt(document.getElementById("seconds1").value);
    const seconds2 = parseInt(document.getElementById("seconds2").value);
    repeat = parseInt(document.getElementById("times").value);

    count1 = seconds1;
    count2 = seconds2;
    display.innerHTML = count1;

    startTime = Date.now();

    timer = setInterval(() => {
      const elapsedTime = Math.floor((Date.now() - startTime) / 1000);
      document.getElementById("elapsed").innerHTML = `経過時間: ${elapsedTime}秒`;

      if (count1 > 0) {
        count1--;
        display.innerHTML = count1;

        if (count1 === 30) {
          beep30.play();
        } else if (count1 === 20) {
          beep20.play();
        } else if (count1 === 10) {
          beep10.play();
        } else if (count1 === 0) {
          finish.play();
        }
      } else if (count2 > 0) {
        count2--;
        display.innerHTML = count2;

        if (count2 === 30) {
          beep30.play();
        } else if (count2 === 20) {
          beep20.play();
        } else if (count2 === 10) {
          beep10.play();
        } else if (count2 === 0) {
          finish.play();
        }
      } else {
        repeat--;
        if (repeat === 0) {
          stop();
        } else {
          count1 = seconds1;
          count2 = seconds2;
          display.innerHTML = count1;
        }
      }
    }, 1000);

    document.getElementById("start").disabled = true;
    document.getElementById("stop").disabled = false;
  }

  function stop() {
    clearInterval(timer);
    document.getElementById("start").disabled = false;
    document.getElementById("stop").disabled = true;
    document.getElementById("display").innerHTML = "0";
    document.getElementById("elapsed").innerHTML = "経過時間: 0秒";

    const formGroup = document.querySelector('.form-group');
    const buttons = document.querySelector('.text-center');
    formGroup.style.display = 'flex';
    buttons.style.display = 'block';
  }
</script>
